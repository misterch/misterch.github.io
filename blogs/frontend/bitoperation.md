---
title: '位运算'
date: 2023-07-21
tag: 
 - 位运算
---
## 原码

是最简单的机器数表示法，用最高位表示符号位，其他位存放该数的二进制的绝对值。

```js
//十进制转二进制
2 = 0010
-2 = 1010

1+2 = 0001 + 0010 = 0011
0+(-0) = 0000 + 1000 = 1000 = -0
1+(-1) = 0001 + 1001 = 1010 = -2
```

## 反码

:::tip

正数的反码和原码是一样

负数的反码是在其原码的基础上, 符号位不变，其余各个位取反

:::

```javascript
//十进制3
//二进制原码
0000 0011
//反码
0000 0011

//十进制-3
//符号位取反
1000 0011
//反码
1111 1100

```

## 补码

:::tip

补码=反码+1

计算机以**补码储存二进制**

:::

正数的补码和原码一样

负数的补码是在反码加1

```javascript
//3的原码，正数原反补都都一样
0000 0011
//反码
0000 0011
//补码
0000 0011
========================
//-3的真码，是拿正数3最高位设置成1,1表示负数
1000 0011 === -3 //真码

//计算机储存的是补码，-3需要转换成补码储存

//-3真码取反,除最高位，其余都反码
1111 1100 //反码

//反码+1=补码
1111 1100 + 1=1111 1101
//计算机最终储存的值是 1111 1101
===========================================
//补码转成真码
//先转成反码，即反码= 补码-1
1111 1101 - 1 = 1111 1100
//反码转真码，除最高位，其余取反
1000 0011 = -3
```

## 结论

计算机以补码储存二进制

正数原反补都相同

负数=补码=反码+1

| 十进制 | 二进制 | 原码 | 反码（除符号位，其余取反） | 补码(反码+1) |
| :----: | :----: | :--: | :------------------------: | :----------: |
| 正数2  |  0010  | 0010 |            0010            |     0010     |
| 负数2  |  1010  | 1010 |            1101            |     1110     |



## 位运算&与

二进制对应两位进行逻辑AND运算

> 同为1才为1，其他都为0

0&0=0

0&1=0

1&1=1

相当于对应位**相加之后的进位**

### 应用

#### 判断奇偶

```javascript
//判断一个整数的二进制补码尾部是否【等于1】，等于1即为奇数
X & 1 === X % 2
```

## 位运算|或

二进制对应两位进行逻辑OR运算

> 同为0才为0，其他都为1

0|0=0

1|0=1

1|1=1

## 位运算^异或

二进制对应两位进行逻辑XOR运算

> 相同为0，不同为1
>
> 相当于位**相加**
>
> 两个相同数异或，结果为0
>
> 非0的数与0异或，结果为数字本身

0^0=0

1^1=0

0^1=1

### 应用

#### 不借助临时变量，交换两个数的值

```javascript
let a = 20
let b = 30
//使用异或位运算
a = a^b //10->0000 1010
b = a^b //20->0001 0100
a = a^b //30->0001 1110

//使用ES6解构
[b,a] = [a,b]


//使用加减运算
a = a + b //得到两数的和
b = a - b //两数和减去b的数，现在b等于a的数
a = a - b //两数和减去b的数，现在a等于b的数
```

## 位运算\~取反

二进制运算0变成1,1变成0

```javascript
//对1取相反数

//1的二进制为
1===0000 0001
//对1的二进制取反
~1 1111 1110 //这得到的是计算机储存的【补码】，要转换成【真码】才能得到十进制
//对1111 1110补码转换成反码，反码=补码-1
1111 1101
//反码转成真码（原码），符号位不变，其余取反
1000 0010
//转换成十进制是
-2
~1===-2
```

> **\~n=-(n+1)**

### 应用

#### 取相反数

```javascript
//对12去相反数
~12+1 === -12
```

#### 小数快速取整

```javascript
//12.21545158
~12.21545158 => 取出整数部分12，12取反即~12最终结果为-13
再对-13取反
~-13 === 13-1 === 12
```

## 左移运算符<<

运算格式：被执行左移的十进制数 << 需要左移位数

运算规则：被执行左移的十进制数转换成二进制，**整体左移，在最右边补0**

**总结：整数m左移n位，相当于2的n次方乘以m;m<\<n===m\*(2^n)**

如3<<4&##x20;

二进制表示整数3：0011

&##x20;左移4位即：0011 0000 ，转成十进制即24

十进制表示即：3 \* 2 \* 2 \* 2 === 3 \* 2 \*\* 3

## 右移运算符>>

运算格式：被执行右移的十进制数 >> 需要右移位数

运算规则：被执行右移的十进制数转换成二进制，**整体**右**移，在最左边补0**

**总结：整数m右移n位，相当于m除以2的n次方;m>>n===m/(2^n)**

如100>>3

二进制表示整数100：0110 0100

右移3位即：0000 1100，转换成十进制即12

十进制表示即：100 / 2 / 2 / 2 === 100 / 2 \*\* 3

## 无符号右移动>>>

## JS中位运算的应用场景

### 开关

```javascript
//有三种开关的状态，可以用2位即2bit表示
//2bit可以最多表示4中状态2^2=4
// 四种状态为：00,01,10,11
let permission = {
	read: 0b01,
	whrite: 0b10,
	create: 0b11
}
let readAndWrite = permission.read | permission.write = 3 === 0b11

```

### 一个整数是否是2的幂

```javascript
//如果一个数是2的幂，那么必然是1后面接若干个0
//结果等于0则是2的幂
n & (n - 1) === 0
```

